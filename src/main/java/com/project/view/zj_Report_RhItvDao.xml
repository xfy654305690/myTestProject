<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.project.view.zj_Report_KdDao">
    <select id="zj_Report_RhItv_Zj"  resultType="com.project.model.zj_Report_RhItv_Zj">

        select s.BRANCH_AREA_NAME as Zj_Name,count(*) rh_Amt,
               sum(case when s.ITV_ASSET_ROW_ID is not null then 1 else 0 end ) rh_Add_Amt,
               sum(case when s.ITV_ASSET_ROW_ID is null then 1 else 0 end ) rh_Unadd_Amt,
               sum(case when s.ITV_ASSET_ROW_ID is not null then 1 else 0 end )/count(*) rh_Add_rate
        from XFY_RPT_RH_ORDER_ASSET s
        where s.CPL_DT>=date'2022-01-01'
          and s.KHQ='公众'
        group by s.BRANCH_AREA_NAME

    </select>

</mapper>